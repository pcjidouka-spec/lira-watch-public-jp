# 自動デプロイシステムの構築・再現マニュアル（AWS脱却・モダン同期版）

このドキュメントは、Gitのインストールから、**AWS等のサーバー管理から解放された「GitHub Pages / Vercel」への自動デプロイシステム**を構築・再現するためのマニュアルです。

従来のサーバー（AWS EC2等）を維持する手間とコストを削減し、GitへのプッシュだけでWebサイトを世界中に公開する「モダンな開発フロー」を実現します。

---

## 🛠 準備編：開発環境を整える

### 1. Gitのインストール
ソースコードの管理と、デプロイ（公開）のトリガーとなるツールです。
1.  [Git for Windows公式](https://gitforwindows.org/) からインストーラーをダウンロード。
2.  すべてデフォルト設定でインストール。
3.  PowerShell等の端末で `git --version` が動くことを確認。

### 2. 公開プラットフォームの準備
AWSのサーバー管理は不要です。以下のいずれかのアカウントを作成してください。
- **GitHub Pages**: 静的サイト（HTML/JS）に最適。
- **Vercel**: Next.js等のフレームワークに最適。プッシュするだけで自動ビルドされます。

---

## 🏗 システムの設計思想：AWSからモダン同期へ

従来のシステム（AWS）と、本システム（Git同期）の違いを理解することが再現の近道です。

| 比較項目 | 従来の方式 (AWS) | 本システム (GitHub Pages / Vercel) |
|:---|:---|:---|
| **管理コスト** | インスタンスの管理・パッチ当てが必要 | **サーバー管理不要 (Serverless)** |
| **コスト** | 従量課金、固定費が高い | **無料枠が非常に広く、基本無料** |
| **デプロイ** | FTP送信や複雑なCI/CD設定 | **`git push` するだけで自動反映** |
| SSL (HTTPS) | 証明書の取得・管理が必要 | **自動で設定・更新される** |

---

## 💰 コストと制限事項について

GitHub PagesやVercelを利用することで、サーバー費用を一切かけずにWebサイトを公開することが可能です。ただし、無料プランにはいくつかの制限があることを理解しておく必要があります。

### 無料で利用できる理由
これらのプラットフォームは、オープンソース活動の支援や個人開発者の集客を目的として、非常に強力な無料枠（Hobbyプラン等）を提供しています。

### 主な制限事項
- **商用利用の制限**: 基本的に個人プロジェクトや非営利目的が対象です（Vercel Hobbyなど）。
- **ビルド時間・回数**: 1ヶ月あたりのビルド実行時間や回数に上限があります（個人運用では十分な量です）。
- **帯域幅 (Bandwidth)**: 転送量（アクセス数）が極端に多い場合、制限がかかることがあります。
- **動的機能の制限**: GitHub Pagesは「静的なHTML/JS」のみ対応しており、サーバー側でPHPやPythonを動かすことはできません（本システムのように、ビルド時にデータを埋め込むことで解決します）。

これらの制限は、個人のポートフォリオや小規模な情報サイトを運営する上ではほとんど問題になりません。むしろ、AWSで月々数百円〜数千円払うリスク（設定ミスによる高額請求など）を回避できるメリットの方が圧倒的に大きいです。

---

---

## 📝 再現の手順（ローカルから自動同期）

### 1. フォルダ構成
```text
/my-project
  ├── crawler/           # 【非公開】Python収集スクリプト
  ├── data/              # 【非公開】CSV保存先
  └── public_site/       # 【公開】Next.js等のサイトリポジトリ
```

### 2. 自動化の仕組み
Windowsのタスクスケジューラをエンジンのように使い、以下のサイクルを回します。
1.  **Extraction**: Pythonが自動でデータを集め、CSVを上書きする。
2.  **Sync**: CSVを `public_site/public/data/` へ上書きコピーする。
3.  **Deployment**: `public_site` ディレクトリでGitコマンド（add, commit, push）を自動実行する。
4.  **Automation Check**: Vercel/GitHub側がプッシュを検知し、自動的に新しいサイトを公開する。

---

## 🤖 AI再現用プロンプト

AIに、「AWSを使わない、Git同期ベースの自動更新システム」をゼロから作らせるためのプロンプトです。

> ### 【プロンプト】AWS不要！Git同期型自動デプロイシステムの完全実装
> 
> あなたはクラウドエンジニアです。AWSなどの複雑なインフラ管理を避けたいIT初学者のために、GitHub PagesやVercelをデプロイ先とした「Git同期型自動化システム」の実装コードを作成してください。
> 
> **要件:**
> 1. **アーキテクチャ**: 
>    - ローカルPC（またはGitHub Actionsのセルフホストランナー）でPythonを動かしてデータを集約。
>    - 集約したデータをGitリポジトリ経由でプッシュし、Vercel/GitHub Pagesの自動デプロイ機能をトリガーにする。
> 2. **必要な成果物**:
>    - `auto_sync.bat`: データのコピーから `git push` までを一気にこなすWindows用バッチ。
>    - `initial_setup.txt`: Gitの公開リポジトリとVercel（またはGitHub Pages）を連携させる最短手順。
>    - Pythonスクリプト: データを生成し、保存するサンプルコード。
> 3. **こだわってほしい点**:
>    - AWS S3やEC2を使わず、Gitホスティングの「プッシュ検知ビルド」機能を最大限活かす設計にすること。
>    - 初心者が「デプロイ完了」を把握しやすいよう、処理の最後にサイトURLを表示するなどの工夫。
>    - `PYTHONIOENCODING=utf-8` 等の文字化け対策を標準装備。
> 
> このシステムのメリット（無料・高速・管理不要）を解説しつつ、全ソースコードを出力してください。

---

## 💡 成功のためのヒント
*   **認証の永続化**: 自動プッシュを成功させるために、OSに認証情報を記憶させてください（AIに「git credential managerの設定方法」を聞いてください）。
*   **プライベートとパブリックの使い分け**: データ収集元のスクリプトには秘密情報が含まれるため、必ず**Privateリポジトリ**で管理し、表示用のフロントエンドのみを**Publicリポジトリ**にします。
*   **Vercelの環境変数**: APIキーなどをフロントエンドで使う場合は、Vercelのダッシュボード上で環境変数を設定すれば、ソースコードに書かずに安全に利用できます。
